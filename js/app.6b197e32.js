(function(e){function t(t){for(var s,i,r=t[0],l=t[1],c=t[2],u=0,f=[];u<r.length;u++)i=r[u],Object.prototype.hasOwnProperty.call(n,i)&&n[i]&&f.push(n[i][0]),n[i]=0;for(s in l)Object.prototype.hasOwnProperty.call(l,s)&&(e[s]=l[s]);d&&d(t);while(f.length)f.shift()();return o.push.apply(o,c||[]),a()}function a(){for(var e,t=0;t<o.length;t++){for(var a=o[t],s=!0,r=1;r<a.length;r++){var l=a[r];0!==n[l]&&(s=!1)}s&&(o.splice(t--,1),e=i(i.s=a[0]))}return e}var s={},n={app:0},o=[];function i(t){if(s[t])return s[t].exports;var a=s[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,i),a.l=!0,a.exports}i.m=e,i.c=s,i.d=function(e,t,a){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(i.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)i.d(a,s,function(t){return e[t]}.bind(null,s));return a},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],l=r.push.bind(r);r.push=t,r=r.slice();for(var c=0;c<r.length;c++)t(r[c]);var d=l;o.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("56d7")},"20bf":function(e,t,a){"use strict";var s=a("7467"),n=a.n(s);n.a},"3a31":function(e,t,a){"use strict";var s=a("730e"),n=a.n(s);n.a},"44d9":function(e,t,a){},"452c":function(e,t,a){},4678:function(e,t,a){var s={"./af":"2bfb","./af.js":"2bfb","./ar":"8e73","./ar-dz":"a356","./ar-dz.js":"a356","./ar-kw":"423e","./ar-kw.js":"423e","./ar-ly":"1cfd","./ar-ly.js":"1cfd","./ar-ma":"0a84","./ar-ma.js":"0a84","./ar-sa":"8230","./ar-sa.js":"8230","./ar-tn":"6d83","./ar-tn.js":"6d83","./ar.js":"8e73","./az":"485c","./az.js":"485c","./be":"1fc1","./be.js":"1fc1","./bg":"84aa","./bg.js":"84aa","./bm":"a7fa","./bm.js":"a7fa","./bn":"9043","./bn.js":"9043","./bo":"d26a","./bo.js":"d26a","./br":"6887","./br.js":"6887","./bs":"2554","./bs.js":"2554","./ca":"d716","./ca.js":"d716","./cs":"3c0d","./cs.js":"3c0d","./cv":"03ec","./cv.js":"03ec","./cy":"9797","./cy.js":"9797","./da":"0f14","./da.js":"0f14","./de":"b469","./de-at":"b3eb","./de-at.js":"b3eb","./de-ch":"bb71","./de-ch.js":"bb71","./de.js":"b469","./dv":"598a","./dv.js":"598a","./el":"8d47","./el.js":"8d47","./en-SG":"cdab","./en-SG.js":"cdab","./en-au":"0e6b","./en-au.js":"0e6b","./en-ca":"3886","./en-ca.js":"3886","./en-gb":"39a6","./en-gb.js":"39a6","./en-ie":"e1d3","./en-ie.js":"e1d3","./en-il":"7333","./en-il.js":"7333","./en-nz":"6f50","./en-nz.js":"6f50","./eo":"65db","./eo.js":"65db","./es":"898b","./es-do":"0a3c","./es-do.js":"0a3c","./es-us":"55c9","./es-us.js":"55c9","./es.js":"898b","./et":"ec18","./et.js":"ec18","./eu":"0ff2","./eu.js":"0ff2","./fa":"8df4","./fa.js":"8df4","./fi":"81e9","./fi.js":"81e9","./fo":"0721","./fo.js":"0721","./fr":"9f26","./fr-ca":"d9f8","./fr-ca.js":"d9f8","./fr-ch":"0e49","./fr-ch.js":"0e49","./fr.js":"9f26","./fy":"7118","./fy.js":"7118","./ga":"5120","./ga.js":"5120","./gd":"f6b4","./gd.js":"f6b4","./gl":"8840","./gl.js":"8840","./gom-latn":"0caa","./gom-latn.js":"0caa","./gu":"e0c5","./gu.js":"e0c5","./he":"c7aa","./he.js":"c7aa","./hi":"dc4d","./hi.js":"dc4d","./hr":"4ba9","./hr.js":"4ba9","./hu":"5b14","./hu.js":"5b14","./hy-am":"d6b6","./hy-am.js":"d6b6","./id":"5038","./id.js":"5038","./is":"0558","./is.js":"0558","./it":"6e98","./it-ch":"6f12","./it-ch.js":"6f12","./it.js":"6e98","./ja":"079e","./ja.js":"079e","./jv":"b540","./jv.js":"b540","./ka":"201b","./ka.js":"201b","./kk":"6d79","./kk.js":"6d79","./km":"e81d","./km.js":"e81d","./kn":"3e92","./kn.js":"3e92","./ko":"22f8","./ko.js":"22f8","./ku":"2421","./ku.js":"2421","./ky":"9609","./ky.js":"9609","./lb":"440c","./lb.js":"440c","./lo":"b29d","./lo.js":"b29d","./lt":"26f9","./lt.js":"26f9","./lv":"b97c","./lv.js":"b97c","./me":"293c","./me.js":"293c","./mi":"688b","./mi.js":"688b","./mk":"6909","./mk.js":"6909","./ml":"02fb","./ml.js":"02fb","./mn":"958b","./mn.js":"958b","./mr":"39bd","./mr.js":"39bd","./ms":"ebe4","./ms-my":"6403","./ms-my.js":"6403","./ms.js":"ebe4","./mt":"1b45","./mt.js":"1b45","./my":"8689","./my.js":"8689","./nb":"6ce3","./nb.js":"6ce3","./ne":"3a39","./ne.js":"3a39","./nl":"facd","./nl-be":"db29","./nl-be.js":"db29","./nl.js":"facd","./nn":"b84c","./nn.js":"b84c","./pa-in":"f3ff","./pa-in.js":"f3ff","./pl":"8d57","./pl.js":"8d57","./pt":"f260","./pt-br":"d2d4","./pt-br.js":"d2d4","./pt.js":"f260","./ro":"972c","./ro.js":"972c","./ru":"957c","./ru.js":"957c","./sd":"6784","./sd.js":"6784","./se":"ffff","./se.js":"ffff","./si":"eda5","./si.js":"eda5","./sk":"7be6","./sk.js":"7be6","./sl":"8155","./sl.js":"8155","./sq":"c8f3","./sq.js":"c8f3","./sr":"cf1e","./sr-cyrl":"13e9","./sr-cyrl.js":"13e9","./sr.js":"cf1e","./ss":"52bd","./ss.js":"52bd","./sv":"5fbd","./sv.js":"5fbd","./sw":"74dc","./sw.js":"74dc","./ta":"3de5","./ta.js":"3de5","./te":"5cbb","./te.js":"5cbb","./tet":"576c","./tet.js":"576c","./tg":"3b1b","./tg.js":"3b1b","./th":"10e8","./th.js":"10e8","./tl-ph":"0f38","./tl-ph.js":"0f38","./tlh":"cf75","./tlh.js":"cf75","./tr":"0e81","./tr.js":"0e81","./tzl":"cf51","./tzl.js":"cf51","./tzm":"c109","./tzm-latn":"b53d","./tzm-latn.js":"b53d","./tzm.js":"c109","./ug-cn":"6117","./ug-cn.js":"6117","./uk":"ada2","./uk.js":"ada2","./ur":"5294","./ur.js":"5294","./uz":"2e8c","./uz-latn":"010e","./uz-latn.js":"010e","./uz.js":"2e8c","./vi":"2921","./vi.js":"2921","./x-pseudo":"fd7e","./x-pseudo.js":"fd7e","./yo":"7f33","./yo.js":"7f33","./zh-cn":"5c3a","./zh-cn.js":"5c3a","./zh-hk":"49ab","./zh-hk.js":"49ab","./zh-tw":"90ea","./zh-tw.js":"90ea"};function n(e){var t=o(e);return a(t)}function o(e){if(!a.o(s,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return s[e]}n.keys=function(){return Object.keys(s)},n.resolve=o,e.exports=n,n.id="4678"},"56d7":function(e,t,a){"use strict";a.r(t);a("e260"),a("e6cf"),a("cca6"),a("a79d");var s=a("2b0e"),n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"app"}},[a("router-view")],1)},o=[],i=(a("5c0b"),a("b0a0"),a("2877")),r={},l=Object(i["a"])(r,n,o,!1,null,null,null),c=l.exports,d=a("289d"),u=a("8c4f"),f=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"home"},[a("custom-header",{attrs:{title:"Create",subtitle:"Tools for building and sharing library data"}}),e._m(0),a("custom-footer")],1)},m=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",{staticClass:"hero"},[a("div",{staticClass:"hero-body"},[a("div",{staticClass:"container"},[a("div",{staticClass:"columns"})])])])}],b=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("footer",{staticClass:"footer"},[a("div",{staticClass:"content container"},[a("div",{staticClass:"columns"},[a("div",{staticClass:"column"},[e._m(0),e._m(1),a("p",{staticClass:"control"},[a("a",{staticClass:"button",attrs:{href:"https://github.com/librarieshacked/create-librarydata",target:"_blank"}},[a("b-icon",{attrs:{icon:"github-circle"}}),a("span",[e._v("GitHub")])],1)]),a("p")]),a("div",{staticClass:"column"},[a("router-link",{staticClass:"navbar-item has-text-weight-semibold",attrs:{to:"/",exact:""}},[e._v(" Home ")])],1)])])])},p=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("p",[e._v(" Developed and maintained by "),a("a",{attrs:{href:"https://www.librarieshacked.org",target:"_blank"}},[e._v("Libraries Hacked")]),e._v(". ")])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("p",[a("small",[a("strong",[e._v("Create")]),e._v(" is open source and licensed under the "),a("a",{attrs:{href:"http://opensource.org/licenses/mit-license.php",target:"_blank"}},[e._v("MIT Licence")]),e._v(".")])])}],h={data:function(){return{}},methods:{}},v=h,_=(a("79d8"),Object(i["a"])(v,b,p,!1,null,"8dfa9eb4",null)),j=_.exports,y=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",{staticClass:"header"},[a("div",{staticClass:"container"},[a("h1",{staticClass:"title has-text-primary has-text-weight-bold"},[e._v(e._s(e.title))]),a("h2",{staticClass:"subtitle has-text-grey"},[e._v(e._s(e.subtitle))])]),a("hr")])},g=[],w={data:function(){return{}},methods:{},props:["title","subtitle"]},k=w,C=(a("84dd"),Object(i["a"])(k,y,g,!1,null,"2eb0704a",null)),O=C.exports,x={data:function(){return{}},methods:{},components:{"custom-footer":j,"custom-header":O}},S=x,z=Object(i["a"])(S,f,m,!1,null,null,null),L=z.exports,T=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"home"},[a("custom-header",{attrs:{title:"Libraries dataset",subtitle:"Create and maintain data about your libraries"}}),a("div",{staticClass:"container"},[a("file-upload",{attrs:{file:e.file},on:{"upload-file":function(t){e.file=t},"delete-file":function(t){e.file=null}}}),a("hr"),a("div",{staticClass:"table-container"},[a("b-table",{staticClass:"table is-narrow libraries-table",attrs:{data:e.data,columns:e.columns}})],1)],1),a("b-loading",{attrs:{"is-full-page":!0,active:e.loading,"can-cancel":!1},on:{"update:active":function(t){e.loading=t}}},[a("b-icon",{attrs:{icon:"autorenew",size:"is-large","custom-class":"mdi-spin"}})],1),a("custom-footer")],1)},A=[],E=(a("d3b7"),a("3ca3"),a("ddb0"),a("2b3d"),a("96cf"),a("1da1")),U=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",[a("b-field",{staticClass:"file"},[a("b-upload",{model:{value:e.file,callback:function(t){e.file=t},expression:"file"}},[a("a",{staticClass:"button is-primary"},[a("b-icon",{attrs:{icon:"upload"}}),a("span",[e._v("Click to upload")])],1)]),e.file?a("span",{staticClass:"file-name"},[e._v(" "+e._s(e.file.name)+" ")]):e._e()],1)],1)},P=[],F={props:["file"],data:function(){return{}},methods:{}},$=F,M=Object(i["a"])($,U,P,!1,null,null,null),R=M.exports,D=a("369b"),B={data:function(){return{loading:!1,active_step:0,file:null,data:[],columns:[{field:"local_authority",label:"Local authority"},{field:"library_name",label:"Library name"},{field:"address_1",label:"Address 1"},{field:"address_2",label:"Address 2"},{field:"address_3",label:"Address 3"},{field:"postcode",label:"Postcode"},{field:"statutory",label:"Statutory"},{field:"type_of_library",label:"Type of library"},{field:"year_opened",label:"Year opened"},{field:"year_closed",label:"Year closed"},{field:"",label:"Address 3"},{field:"address_3",label:"Address 3"},{field:"address_3",label:"Address 3"},{field:"address_3",label:"Address 3"}]}},methods:{confirmFile:function(){var e=Object(E["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}(),confirmOptions:function(){},downloadFile:function(e,t){var a=new Blob([D["unparse"](t)],{type:"text/csv;charset=utf-8;"});if(navigator.msSaveBlob)navigator.msSaveBlob(a,e);else{var s=document.createElement("a");s.href=window.URL.createObjectURL(a),s.setAttribute("download",e),document.body.appendChild(s),s.click(),document.body.removeChild(s)}}},components:{"custom-footer":j,"file-upload":R,"custom-header":O}},I=B,Y=(a("20bf"),Object(i["a"])(I,T,A,!1,null,null,null)),N=Y.exports,V=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"home"},[a("custom-header",{attrs:{title:"Postcode to LSOA",subtitle:"Convert postcode data to use lower super output areas"}}),a("div",{staticClass:"container"},[a("b-steps",{attrs:{size:"is-medium",type:"is-danger","has-navigation":!1,animated:!0},model:{value:e.active_step,callback:function(t){e.active_step=t},expression:"active_step"}},[a("b-step-item",{attrs:{label:"File",icon:"cloud-upload"}},[a("b-message",{attrs:{type:"is-danger"}},[a("p",[e._v(" This tool ensures postcodes are kept secure. Postcode sectors are used to retrieve all possible postcode/LSOA pairings. The correct ones are then chosen, without the full postcodes needing to leave your local PC. ")])]),a("div",{staticClass:"columns"},[a("div",{staticClass:"column"},[a("file-upload",{attrs:{file:e.file},on:{"upload-file":function(t){e.file=t},"delete-file":function(t){e.file=null}}}),a("br"),a("b-button",{attrs:{"icon-right":"chevron-right",disabled:null===e.file,rounded:!0},on:{click:e.confirmFile}},[e._v(" Next ")])],1),a("div",{staticClass:"column"},[a("b-message",{staticClass:"content",attrs:{type:"is-info"}},[a("p",[a("b",[e._v("File tips")])]),a("ol",[a("li",[e._v("Select your CSV file that contains postcodes")]),a("li",[e._v("The first row of the file should be column headings.")]),a("li",[e._v("One column should contain UK postcodes.")])])]),a("b-message",{staticClass:"content",attrs:{type:"is-warning"}},[a("p",[a("b",[e._v("No CSV, no conversion")])]),a("p",[e._v(" If your data isn't a CSV file you'll need to use software to save it as a CSV first. Try "),a("b",[e._v("Save as")]),e._v(" in your software. ")])])],1)])],1),a("b-step-item",{attrs:{label:"Options",icon:"settings"}},[a("div",{staticClass:"columns"},[a("div",{staticClass:"column"},[a("b-field",{attrs:{label:"Postcode column"}},[a("b-select",{attrs:{size:"is-medium",placeholder:"Select column"},model:{value:e.postcode_column,callback:function(t){e.postcode_column=t},expression:"postcode_column"}},e._l(e.columns,(function(t){return a("option",{key:t,domProps:{value:t}},[e._v(e._s(t)+" ")])})),0)],1),a("br"),a("b-button",{attrs:{"icon-right":"chevron-right",disabled:""===e.postcode_column,rounded:!0},on:{click:e.confirmOptions}},[e._v("Convert ")]),a("hr"),a("b-field",{attrs:{label:"Count column (optional)"}},[a("b-select",{attrs:{size:"is-medium",placeholder:"Count of postcodes"},model:{value:e.counts_column,callback:function(t){e.counts_column=t},expression:"counts_column"}},[a("option",{attrs:{value:""}}),e._l(e.columns.filter((function(t){return t!==e.postcode_column})),(function(t){return a("option",{key:t,domProps:{value:t}},[e._v(e._s(t)+" ")])}))],2)],1)],1),a("div",{staticClass:"column"},[a("b-message",{staticClass:"content",attrs:{type:"is-info"}},[a("p",[a("b",[e._v("Choose your columns")])]),a("p",[e._v("These lists show the column headings in your data.")]),a("ol",[a("li",[e._v("Select the correct column for the postcodes")]),a("li",[e._v("Check guidance below on the optional step")]),a("li",[e._v(" When ready, select the "),a("strong",[e._v("Convert")]),e._v(" option to continue ")])]),a("p",[e._v(" It may take a few minutes depending on how many postcodes there are. ")])]),a("b-message",{staticClass:"content",attrs:{type:"is-warning"}},[a("p",[a("b",[e._v("Optional step: Library data")])]),a("p",[e._v(" If your data includes how many people live in each postcode, select the column this count is held in. The tool will then be able to count people per LSOA to compile "),a("a",{attrs:{href:"https://schema.librarydata.uk/membership",target:"_blank"}},[e._v("library membership data ")]),e._v(" for you. ")]),a("p",[e._v(" If each of your rows relates to one person, or you only want to convert postcodes, you can ignore this option. ")])])],1)])]),a("b-step-item",{attrs:{label:"Download",icon:"cloud-download"}},[a("div",{staticClass:"columns"},[a("div",{staticClass:"column"},[a("h3",{staticClass:"content title is-4"},[e._v("Complete")]),a("h4",{staticClass:"content subtitle is-6"},[e._v(" "+e._s("Completed in "+e.getTimeCompleted()+" seconds")+" ")]),a("b-table",{staticClass:"summary-table",attrs:{data:e.summary_data,columns:e.summary_columns}}),a("br"),a("b-button",{attrs:{type:"is-primary","icon-right":"download",rounded:!0},on:{click:e.downloadConvertedFile}},[e._v("Download converted file")])],1),a("div",{staticClass:"column"},[a("b-message",{staticClass:"content",attrs:{type:"is-info"}},[a("p",[a("b",[e._v("Converted file")])]),a("p",[e._v("These changes have been applied:")]),a("ul",[a("li",[e._v("Postcodes are changed to their LSOA.")]),a("li",[e._v(" Old postcodes are changed to "),a("strong",[e._v("Terminated")]),e._v(". ")]),a("li",[e._v(" Any that weren't recognised are changed to "),a("strong",[e._v("Unknown")]),e._v(". ")]),a("li",[e._v(" The column header is changed to "),a("strong",[e._v("LSOA")]),e._v(". ")])])])],1)]),a("hr"),a("div",{staticClass:"columns"},[a("div",{staticClass:"column"},[a("h4",{staticClass:"content title is-5"},[e._v("Library membership")]),a("h5",{staticClass:"content subtitle is-6"},[e._v("Prepare your data")]),a("b-field",{attrs:{label:"Local authority name"}},[a("b-input",{model:{value:e.authority,callback:function(t){e.authority=t},expression:"authority"}})],1),a("b-field",{attrs:{label:"Count date"}},[a("b-datepicker",{attrs:{placeholder:"Type or select a date...",icon:"calendar-today",editable:""},model:{value:e.extract_date,callback:function(t){e.extract_date=t},expression:"extract_date"}})],1),a("b-button",{attrs:{type:"is-secondary","icon-right":"download",disabled:""===e.authority||null===e.extract_date,rounded:!0},on:{click:e.downloadSchemaFile}},[e._v("Download membership file")])],1),a("div",{staticClass:"column"},[a("b-message",{staticClass:"content",attrs:{type:"is-warning"}},[a("p",[a("b",[e._v("Library data")])]),a("p",[e._v(" LSOAs are required for "),a("a",{attrs:{href:"https://schema.librarydata.uk/membership",target:"_blank"}},[e._v("library membership data")]),e._v(". ")]),a("p",[e._v("This tool has calculated a count of members per LSOA.")]),a("ol",[a("li",[e._v("Fill out the name of your library service.")]),a("li",[e._v(" Select the date the postcodes were extracted from your database. ")]),a("li",[e._v("Download the data file ready for checking.")])])])],1)])])],1)],1),a("b-loading",{attrs:{"is-full-page":!0,active:e.loading,"can-cancel":!1},on:{"update:active":function(t){e.loading=t}}},[a("b-icon",{attrs:{icon:"autorenew",size:"is-large","custom-class":"mdi-spin"}})],1),a("custom-footer")],1)},H=[],q=(a("4de4"),a("4160"),a("c975"),a("d81d"),a("b64b"),a("ac1f"),a("25f0"),a("5319"),a("159b"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",[a("b-field",{attrs:{label:"Choose file from your computer"}},[a("b-upload",{attrs:{type:"is-light",accept:".csv","drag-drop":""},on:{input:function(t){return e.$emit("upload-file",t)}}},[a("section",{staticClass:"section"},[a("div",{staticClass:"content has-text-centered"},[a("p",[a("b-icon",{attrs:{icon:"upload",size:"is-medium"}})],1),a("p",[e._v("Drop your CSV file here or click to add")])])])])],1),a("div",{staticClass:"tags"},[e.file?a("span",{staticClass:"tag is-medium is-info"},[e._v(" "+e._s(e.file.name)+" "),a("button",{staticClass:"delete is-medium",attrs:{type:"button"},on:{click:function(t){return e.$emit("delete-file")}}})]):e._e()])],1)}),G=[],J={props:["file"],data:function(){return{}},methods:{}},Z=J,K=Object(i["a"])(Z,q,G,!1,null,null,null),W=K.exports,Q=a("c1df"),X=a.n(Q);function ee(e){return new Promise((function(t){var a=[];D["parse"](e,{skipEmptyLines:!0,worker:!0,step:function(e){a.push(e.data)},complete:function(){t(a)}})}))}a("6062"),a("466d"),a("498a");var te=a("2909"),ae=a("bc3a"),se=a.n(ae),ne=a("9843");function oe(e){var t=new Set(e.map((function(e){return ie(e)})).filter((function(e){return null!=e})));return Object(te["a"])(t)}function ie(e){var t=/[a-zA-Z]+\d\d?[a-zA-Z]?\s*\d+/;if(e){var a=e.match(t);if(a&&a.length>0)return a[0]}return null}function re(e,t){se.a.post(ne.postcode_api+"lsoas?filter=sector",e).then((function(e){t(e.data)}))}function le(e,t){var a=oe(e),s={};re(a,(function(e){Object.keys(e).forEach((function(t){e[t].forEach((function(e){s[e.replace(/\s/g,"")]=t.trim()}))})),t(s)}))}var ce={data:function(){return{start_time:null,end_time:null,loading:!1,loading_message:"",active_step:0,columns:[],file:null,postcode_column:"",counts_column:"",csv_data:[],lsoas_counted:{},summary_data:[{total:0,converted:0,terminated:0,unknown:0}],summary_columns:[{field:"total",label:"Total"},{field:"converted",label:"Successful"},{field:"terminated",label:"Terminated"},{field:"unknown",label:"Unknown"}],authority:"",extract_date:null}},methods:{getTimeCompleted:function(){return this.start_time&&this.end_time?Math.round(X.a.duration(this.end_time.diff(this.start_time)).asSeconds()):""},confirmFile:function(){var e=Object(E["a"])(regeneratorRuntime.mark((function e(){var t,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t=this,t.start_time=X()(),t.loading=!0,t.loading_message="Analysing file",null===t.file){e.next=13;break}return e.next=7,ee(t.file);case 7:a=e.sent,t.columns=a[0],t.csv_data=a,t.loading=!1,t.end_time=X()(),t.active_step=1;case 13:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),confirmOptions:function(){var e=this,t=this;t.start_time=X()(),t.loading=!0,t.loading_message="Collecting postcodes",t.summary_data[0].total=0,t.summary_data[0].converted=0,t.summary_data[0].unknown=0,t.summary_data[0].terminated=0;var a=this.columns.indexOf(t.postcode_column),s=t.columns.indexOf(this.counts_column),n=t.csv_data.map((function(e,s){var n=e[a];if(0!=s&&n!==t.postcode_column)return n})).filter((function(e){return null!=e}));t.loading_message="Fetching LSOAs",le(n,(function(n){t.loading_message="Replacing postcodes",e.lsoas_counted["Unknown"]=0,t.csv_data.forEach((function(o,i){var r=o[a],l=r.replace(/\s/g,"");if(0===i&&r===t.postcode_column)o[a]="LSOA";else{e.summary_data[0].total++;var c="";r&&""!==r&&n[l]?(c=n[l],"Terminated"===c?(o[a]="Terminated",e.summary_data[0].terminated++):"Unknown"===c?(o[a]="Unknown",e.summary_data[0].unknown++):(o[a]=c,e.summary_data[0].converted++),e.lsoas_counted[c]||(e.lsoas_counted[c]=0)):(o[a]="Unknown",e.summary_data[0].unknown++,c="Unknown"),"Terminated"===c&&(c="Unknown"),""!==e.counts_column?e.lsoas_counted[c]=e.lsoas_counted[c]+parseInt(o[s]):e.lsoas_counted[c]++}})),t.active_step=2,e.loading=!1,e.end_time=X()()}))},downloadConvertedFile:function(){this.downloadFile("converted.csv",this.csv_data)},downloadSchemaFile:function(){var e=Object(E["a"])(regeneratorRuntime.mark((function e(){var t,a,s,n=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t=[["Local authority","Count date","Area code","Members"]],a=X()(this.extract_date).format("YYYY-MM-DD"),Object.keys(this.lsoas_counted).filter((function(e){return"Unknown"!==e&&"Terminated"!==e})).forEach((function(e){var s=n.lsoas_counted[e];t.push([n.authority,a,e,s>4?s.toString():"x"])})),s=this.lsoas_counted["Unknown"],this.lsoas_counted["Unknown"]>0&&t.push([this.authority,a,"Unknown",s>4?s.toString():"x"]),this.downloadFile("membership.csv",t);case 6:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),downloadFile:function(e,t){var a=new Blob([D["unparse"](t)],{type:"text/csv;charset=utf-8;"});if(navigator.msSaveBlob)navigator.msSaveBlob(a,e);else{var s=document.createElement("a");s.href=window.URL.createObjectURL(a),s.setAttribute("download",e),document.body.appendChild(s),s.click(),document.body.removeChild(s)}}},components:{"custom-footer":j,"file-upload":W,"custom-header":O}},de=ce,ue=(a("3a31"),Object(i["a"])(de,V,H,!1,null,null,null)),fe=ue.exports;s["a"].use(u["a"]);var me=new u["a"]({mode:"history",base:"/",routes:[{path:"/",name:"home",component:L},{path:"/postcode-to-lsoa",name:"postcode-to-lsoa",component:fe},{path:"/libraries",name:"libraries",component:N}]});s["a"].config.productionTip=!1,s["a"].use(d["a"]),new s["a"]({router:me,render:function(e){return e(c)}}).$mount("#app")},"5c0b":function(e,t,a){"use strict";var s=a("9c0c"),n=a.n(s);n.a},"730e":function(e,t,a){},7467:function(e,t,a){},"79d8":function(e,t,a){"use strict";var s=a("44d9"),n=a.n(s);n.a},"84dd":function(e,t,a){"use strict";var s=a("e7ad"),n=a.n(s);n.a},9843:function(e){e.exports=JSON.parse('{"postcode_api":"https://api-geography.azurewebsites.net/rest/postcodes/","schema_path":"https://raw.githubusercontent.com/LibrariesHacked/schema-librarydata/master/archive/","schemas":{"membership":{"name":"Membership","version":"0.3.0"}}}')},"9c0c":function(e,t,a){},b0a0:function(e,t,a){"use strict";var s=a("452c"),n=a.n(s);n.a},e7ad:function(e,t,a){}});
//# sourceMappingURL=app.6b197e32.js.map